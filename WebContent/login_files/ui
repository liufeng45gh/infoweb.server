document.write("<ul class=\"passport-login-input-ul\" id=\"pptmobilecodeloginul\">\r\n	<li class=\"passport-login-input-li\"  id=\"mobileLoginTipLi\" style=\"display:none;\">\r\n		<span class=\"passport-login-tip\" id=\"mobileLoginTip\"><\/span>\r\n	<\/li>\r\n	<input type=\"hidden\" name=\"source\" id=\"source\" value=\"pc-login\" \/>\r\n	<input type=\"hidden\" name=\"risktype\" id=\"risktype\" value=\"1\" \/>\r\n	<li id=\"mobilecodeloginMobileLi\" class=\"passport-login-input-li\">\r\n		<span class=\"passport-login-input-span\">手机号<\/span><input type=\"text\" class=\"passport-login-input passport-login-input-mobile c_ccc\" value=\"请输入手机号\" name=\"pptmobilecodeloginmobile\" id=\"pptmobilecodeloginmobile\" maxlength=\"11\" >\r\n	<\/li>\r\n	<li id=\"mobilecodeloginVcodeLi\" class=\"passport-login-input-li\" style=\"display:none;\"><\/li>\r\n	<li id=\"mobilecodeloginSendMobileCodeLi\" class=\"passport-login-input-li\">\r\n		<span class=\"passport-login-input-span\">&nbsp;<\/span><input type=\"button\" name=\"pptmobilecodeloginresendbtn\" id=\"pptmobilecodeloginresendbtn\" value=\"获取手机短信确认码\" class=\"passport-login-mobilecode-button\">\r\n		<div id=\"mobilecodeloginSendMobileCodesendok\" name=\"mobilecodeloginSendMobileCodesendok\" class=\"mobilesendtip\" style=\"display:;\">\r\n		<\/div>\r\n	<\/li>\r\n	<div id=\"ppt_login\" style=\"display:none;\">\r\n		<li id=\"mobilecodeloginMobileCodeLi\" class=\"passport-login-input-li\">\r\n			<span class=\"passport-login-input-span\">手机确认码<\/span><input type=\"text\" name=\"pptmobilecodeloginmobilecode\" id=\"pptmobilecodeloginmobilecode\" maxlength=\"6\" class=\"passport-login-input passport-login-input-mobilecode\" maxlength=\"10\">\r\n		<\/li>\r\n		<li id=\"mobilecodeloginButtonLi\" class=\"passport-login-input-li\">\r\n			<span class=\"passport-login-input-span\">&nbsp;<\/span>\r\n			<label id=\"mobilecodeloginButtonLable\" class=\"login_grey\"><input type=\"submit\" name=\"pptmobilecodeloginButton\" id=\"pptmobilecodeloginButton\" value=\"登录\" class=\"passport-login-button\"><\/label>\r\n		<\/li>\r\n	<\/div>\r\n<\/ul>\r\n<script type=\"text\/javascript\">\r\n	var isSend = false;\r\n	$(function() {\r\n		\/\/验证手机号\r\n		$(\"#pptmobilecodeloginmobile\").bind(\"blur\", function() {\r\n			$(this).val(mobileUi.QtoB(this.value));\r\n			if (!validMobileFormat(this.value)) {\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(this).removeClass(\"c_ccc action_color\");$(this).addClass(\"wrong_color\");\r\n				$(\"#mobileLoginTip\").html(\"请填写正确的手机号码！\");\r\n			} else {\r\n				$(this).removeClass(\"c_ccc wrong_color action_color\");\r\n				$(\"#mobileLoginTipLi\").hide();\r\n				$(\"#mobileLoginTip\").html(\"\");\r\n			}\r\n			if ($(this).val() == \"\") {\r\n				$(this).addClass(\"c_ccc\");\r\n				$(this).val(\"请输入手机号\");\r\n			}\r\n		}).bind(\"focus\", function() {\r\n			$(\"#mobileLoginTipLi\").hide();\r\n			$(this).addClass(\"action_color\");\r\n			if ($(this).val() == \"请输入手机号\") {\r\n				$(this).removeClass(\"c_ccc wrong_color\");\r\n				$(this).val(\"\");\r\n			}\r\n		}).bind(\"keyup\", function(){\r\n			$(this).val($(this).val().replace(\/[^0-9]\/g,''));\r\n		});\r\n\r\n		\/\/获取手机验证码\r\n		$(\"#pptmobilecodeloginresendbtn\").bind(\"click\", function() {\r\n			$(\"#pptmobilecodeloginresendbtn\").attr(\"disabled\", \"disabled\");\r\n			$(\"#mobileLoginTipLi\").hide();\r\n			mobile = $(\"#pptmobilecodeloginmobile\").val();\r\n			if (!validMobileFormat(mobile)) {\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(\"#pptmobilecodeloginmobile\").removeClass(\"action_color\");$(\"#pptmobilecodeloginmobile\").addClass(\"wrong_color\");\r\n				$(\"#mobileLoginTip\").html(\"请填写正确的手机号码！\");\r\n				$(\"#pptmobilecodeloginresendbtn\").removeAttr(\"disabled\");\r\n			} else {\r\n				var pptmobilecodeloginvcode = \"\";\r\n				if ($(\"#passport-login-code\") && $(\"#passport-login-code\").html() != null) {\r\n					if ($(\"#pptmobilecodeloginvcode\")) {\r\n						pptmobilecodeloginvcode = $(\"#pptmobilecodeloginvcode\").val();\r\n					}\r\n				}\r\n				getCode(mobile, pptmobilecodeloginvcode);\r\n			}\r\n		});\r\n		\r\n\r\n		\/\/验证手机确认码\r\n		$(\"#pptmobilecodeloginmobilecode\").bind(\"blur\", function() {\r\n			$(this).val(mobileUi.QtoB(this.value));\r\n			if (this.value.length < 6) {\r\n				$(this).removeClass(\"action_color\");$(this).addClass(\"wrong_color\");\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(\"#mobileLoginTip\").html(\"请填写正确的手机确认码！\");\r\n				\/\/按钮置灰并变为不可用状态\r\n				$(\"#mobilecodeloginButtonLable\").addClass(\"login_grey\");\r\n			} else {\r\n				\/\/颜色变黄\r\n				$(\"#mobilecodeloginButtonLable\").removeClass(\"login_grey\");\r\n				\r\n				$(this).removeClass(\"wrong_color\");$(this).addClass(\"action_color\");\r\n				$(\"#mobileLoginTipLi\").hide();\r\n				$(\"#mobileLoginTip\").html(\"\");\r\n			}\r\n		}).bind(\"focus\", function() {\r\n			$(\"#mobileLoginTipLi\").hide();\r\n			$(this).addClass(\"action_color\");\r\n		}).bind(\"keyup\", function() {\r\n			if (this.value.length == 6) {\r\n				\/\/颜色变黄\r\n				$(\"#mobilecodeloginButtonLable\").removeClass(\"login_grey\");\r\n			}else{\r\n				\/\/颜色变灰\r\n				$(\"#mobilecodeloginButtonLable\").addClass(\"login_grey\");\r\n			}\r\n		});\r\n\r\n		\/\/提交登录\r\n		$(\"#pptmobilecodeloginButton\").bind(\"click\", function() {\r\n			\/\/验证手机号\r\n			mobile = $(\"#pptmobilecodeloginmobile\").val();\r\n			if(mobile == null || mobile.length == 0){\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(\"#pptmobilecodeloginmobile\").addClass(\"c_ccc wrong_color\");\r\n				$(\"#mobileLoginTip\").html(\"请输入手机号码！\");\r\n				return false;\r\n			}\r\n			\r\n			if (!validMobileFormat(mobile)) {\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(\"#pptmobilecodeloginmobile\").addClass(\"c_ccc wrong_color\");\r\n				$(\"#mobileLoginTip\").html(\"请填写正确的手机号码！\");\r\n				return false;\r\n			}\r\n			if(!isSend){\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(\"#pptmobilecodeloginmobile\").addClass(\"c_ccc wrong_color\");\r\n				$(\"#mobileLoginTip\").html(\"请点击获取手机短信确认码按钮！\");\r\n				return false;\r\n			}\r\n			pptmobilecodeloginvcode = \"\";\r\n			\/\/验证手机认证码\r\n			mobilecode = $(\"#pptmobilecodeloginmobilecode\").val();\r\n			if (mobilecode.length < 6) {\r\n				$(\"#pptmobilecodeloginmobilecode\").addClass(\"wrong_color\");\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(\"#mobileLoginTip\").html(\"请填写正确的手机确认码！\");\r\n				return false;\r\n			} else {\r\n				$(\"#pptmobilecodeloginmobilecode\").removeClass(\"wrong_color\");\r\n			}\r\n			codeCommitLogin(mobile, mobilecode, pptmobilecodeloginvcode);\r\n		});\r\n	});\r\n\r\n	function codeCommitLogin(mobile, mobilecode, vcode) {\r\n		$(\"#pptmobilecodeloginButton\").attr(\"disabled\", \"disabled\");\r\n		source = $(\"#source\").val();\r\n		risktype = $(\"#risktype\").val();\r\n		url = \"https:\/\/passport.58.com\/mobileauthcodelogin\/login?mobile=\" + mobile + \"&mobilevcode=\" + mobilecode + \"&validatecode=\" + vcode +\"&source=\" + source + \"&risktype=\" + risktype + \"&callback=?\";\r\n		$.getJSON(url, function(result) {\r\n			codeSuccessCommitLoginFunction(result);\r\n		});\r\n	}\r\n\r\n	function codeSuccessCommitLoginFunction(result) {\r\n		$(\"#pptmobilecodeloginButton\").removeAttr(\"disabled\");\r\n		if (result.code == 0) {\r\n			if (result.data.ppu) {\r\n				\/\/need write cookie, { path: '\/', expires: 1 });\r\n				var exp = new Date();\r\n				var expires_time = exp.getTime() + (14 * 24 * 60 * 60 * 1000);\r\n				\/\/14 DAYS\r\n				$.cookie(\"PPU\", result.data.ppu, {\r\n					path : result.data.path,\r\n					expires : expires_time\r\n				});\r\n			}\r\n			mobileloginSuccessFunction();\r\n			return true;\r\n		} else if (result.code == 15) {\r\n			$(\"#mobileLoginTipLi\").show();\r\n			$(\"#mobileLoginTip\").html(\"请填写正确的手机确认码！\");\r\n			$(\"#pptmobilecodeloginmobilecode\").removeClass(\"action_color\");\r\n			$(\"#pptmobilecodeloginmobilecode\").addClass(\"wrong_color\");\r\n		} else if (result.code == 1) {\r\n			$(\"#mobileLoginTipLi\").show();\r\n			$(\"#mobileLoginTip\").html(\"请填写正确的手机号码！\");\r\n		} else if (result.code == 9) {\/\/高危\r\n			window.location.href = \"http:\/\/passport.58.com\/warnuser?risktype=1&path=http:\/\/my.58.com&errorpath=http:\/\/passport.58.com\/login\";\r\n		} else {\r\n			$(\"#mobileLoginTipLi\").show();\r\n			$(\"#mobileLoginTip\").html(result.msg);\r\n		} \r\n	}\r\n\r\n	\/**\r\n	 * get vcode\r\n	 *\/\r\n	function getValidateCode() {\r\n		if($(\"#pptmobilecodeloginvcode\").val() != \"请填写图片验证码\"){\r\n			$(\"#pptmobilecodeloginvcode\").val(\"\");\r\n		}\r\n		$(\"#vcodeTelImg\").attr(\"src\", \"https:\/\/passport.58.com\/validatecode?temp=123\" + (new Date().getTime().toString(36)));\r\n	}\r\n\r\n	\/**\r\n	 * get mobile code\r\n	 *\/\r\n	function getCode(mobile, vcode) {\r\n		addLog(\"phonecode_btn\");\r\n		source = $(\"#source\").val();\r\n		url = \"https:\/\/passport.58.com\/mobileauthcodelogin\/getcode?mobile=\" + mobile + \"&validatecode=\" + vcode + \"&source=\" + source + \"&callback=?\";\r\n		$.getJSON(url, function(result) {\r\n			successGetCodeFunction(result);\r\n		});\r\n	}\r\n\r\n	function successGetCodeFunction(result) {\r\n		if (result.code == 0) {\r\n			isSend = true;\r\n			\/\/增加timeout的时间倒序\r\n			$(\"#mobilecodeloginSendMobileCodesendok\").show();\r\n			\/\/按钮变成灰色\r\n			$(\"#pptmobilecodeloginresendbtn\").removeClass(\"mobilecode_yellow\");\r\n			$(\"#pptmobilecodeloginresendbtn\").addClass(\"mobilecode_grey\");\r\n			\r\n			var sendokhtml = '<img src=\"http:\/\/img.58cdn.com.cn\/ui6\/my\/images\/sendok.png\"\/>确认码短信已经发到您的手机，请查收！';\r\n			$(\"#mobilecodeloginSendMobileCodesendok\").html(sendokhtml);\r\n			mobilelogincountresent(180);\r\n			\/\/隐藏验证码\r\n			$(\"#mobilecodeloginVcodeLi\").html(\"\");\r\n			$(\"#mobilecodeloginVcodeLi\").hide();\r\n			\/\/隐藏提示语\r\n			$(\"#mobileLoginTipLi\").hide();\r\n			$(\"#mobileLoginTip\").html(\"\");\r\n			\/\/显示登录按钮\r\n			$(\"#ppt_login\").show();\r\n		} else if (result.code == 98){\r\n			$(\"#mobilecodeloginVcodeLi\").show();\r\n			\/\/增加验证码逻辑\r\n			addLog(\"pic\");\r\n			if (!$(\"#passport-login-code\") || $(\"#passport-login-code\").html() == null) {\r\n				var html = '<span id=\"passport-login-code\" name==\"passport-login-code\" class=\"passport-login-input-span\">验证码<\/span><input type=\"text\" name=\"pptmobilecodeloginvcode\" id=\"pptmobilecodeloginvcode\" value=\"请填写图片验证码\" class=\"passport-login-input passport-login-input-mobile c_ccc\"><img align=\"absmiddle\" name=\"vcodeTelImg\" id=\"vcodeTelImg\" style=\"height:36px;\"><a href=\"javascript:getValidateCode();\">看不清楚？<\/a>';\r\n				$(\"#mobilecodeloginVcodeLi\").html(html);\r\n				\/\/验证码\r\n				$(\"#pptmobilecodeloginvcode\").bind(\"focus\", function(){\r\n					if($(this).val() == \"请填写图片验证码\"){\r\n						$(this).val(\"\");\r\n					}\r\n					$(\"#mobileLoginTipLi\").hide();\r\n					$(this).removeClass(\"wrong_color c_ccc\");\r\n				}).bind(\"blur\", function(){\r\n					if($(this).val() == \"\"){\r\n						$(this).addClass(\"c_ccc\");\r\n						$(this).val(\"请填写图片验证码\");\r\n					}\r\n				});\r\n			} else {\r\n				$(\"#mobileLoginTipLi\").show();\r\n				$(\"#mobileLoginTip\").html(\"请正确填写验证码！\");\r\n				$(\"#pptmobilecodeloginvcode\").addClass(\"wrong_color\");\r\n			}\r\n			getValidateCode();\r\n			$(\"#pptmobilecodeloginresendbtn\").removeAttr(\"disabled\");\r\n		} else{\r\n			$(\"#mobileLoginTipLi\").show();\r\n			$(\"#mobileLoginTip\").html(result.msg);\r\n			$(\"#pptmobilecodeloginresendbtn\").removeAttr(\"disabled\");\r\n		}\r\n	}\r\n\r\n	function addLog(type) {\r\n		try {\r\n			source = $(\"#source\").val();\r\n			if (!source) {\r\n				clickLog(\"from=passport_login_\" + type);\r\n			} else {\r\n				clickLog(\"from=\" + source + \"_\" + type);\r\n			}\r\n		} catch (e) {\r\n		}\r\n	}\r\n\r\n	function mobilelogincountresent(resendtime) {\r\n		var sel = setInterval(function() {\r\n			if (resendtime == 0) {\r\n				$(\"#pptmobilecodeloginresendbtn\").removeAttr(\"disabled\").removeClass(\"countdown\");\r\n				$(\"#pptmobilecodeloginresendbtn\").val(\"获取手机短信确认码\");\r\n				\/\/隐藏提示信息\r\n				$(\"#mobilecodeloginSendMobileCodesendok\").hide();\r\n				\/\/按钮变成yellow\r\n				$(\"#pptmobilecodeloginresendbtn\").removeClass(\"mobilecode_grey\");\r\n				$(\"#pptmobilecodeloginresendbtn\").addClass(\"mobilecode_yellow\");\r\n				\r\n				clearInterval(sel);\r\n				return;\r\n			}\r\n			$(\"#pptmobilecodeloginresendbtn\").attr(\"disabled\", \"disabled\").addClass(\"countdown\");\r\n			$(\"#pptmobilecodeloginresendbtn\").val(resendtime + \"秒,重发手机确认码\");\r\n			resendtime--;\r\n		}, 1000);\r\n	}\r\n\r\n	var mobileUi = {\r\n		QtoB : function(a) {\r\n			for (var c = \"\", d = 0; d < a.length; d++) {\r\n				c += a.charCodeAt(d) == 12288 ? String.fromCharCode(a.charCodeAt(d) - 12256) : a.charCodeAt(d) > 65280 && a.charCodeAt(d) < 65375 ? String.fromCharCode(a.charCodeAt(d) - 65248) : String.fromCharCode(a.charCodeAt(d));\r\n			}\r\n			return c;\r\n		}\r\n	};\r\n\r\n	\/**\r\n	 * check mobile\r\n	 *\/\r\n	function validMobileFormat(mobile) {\r\n		var numberRegStr = \/^\\d{11}$\/;\r\n		var regNum = new RegExp(numberRegStr);\r\n		if (regNum.test(mobile)) {\r\n			var telRegStr = \/^(13|14|15|17|18)\\d{9}$\/;\r\n			var reg = new RegExp(telRegStr);\r\n			if (reg.test(mobile))\r\n				return true;\r\n			else\r\n				return false;\r\n		} else {\r\n			return false;\r\n		}\r\n	}\r\n\r\n<\/script>");